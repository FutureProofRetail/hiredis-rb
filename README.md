# redis_ext

Ruby extension that wraps [hiredis](http://github.com/antirez/hiredis) reply
parsing code. It is targeted at speeding up parsing multi bulk replies.

It is bundled with this specific branch of hiredis (until that branch is
merged to master):
[pietern/hiredis/buffer](http://github.com/pietern/hiredis/tree/buffer).

## WARNING

This code is considered alpha. Do not use it for other purposes than
testing _yet_.

## Install

Install with Rubygems:

    gem install redis_ext --pre

## Usage

This gem can be used by simply requiring it. When it is required _after_
the `redis` gem is loaded, it automatically patches it to use `redis_ext`.

## Benchmarks

These numbers were generated by running `benchmark/compare.rb` against
`ruby 1.8.7 (2010-08-16 patchlevel 302) [i686-darwin10.4.0]`. Because this
extension is only concerned with optimizing the code for parsing the reply,
parse code, this is the only thing that is benchmarked here. This does **not**
take I/O in account.

For simple line or bulk replies, the throughput improvement is insignificant,
while the larger multi bulk responses will have a noticeable higher throughput.

                                                            user     system      total        real
    ruby:100000x bulk (10 bytes)                        0.390000   0.000000   0.390000 (  0.387764)
     ext:100000x bulk (10 bytes)                        0.090000   0.000000   0.090000 (  0.090202)
    ruby:100000x bulk (100 bytes)                       0.400000   0.000000   0.400000 (  0.399499)
     ext:100000x bulk (100 bytes)                       0.090000   0.010000   0.100000 (  0.096638)
    ruby:100000x bulk (1000 bytes)                      0.430000   0.020000   0.450000 (  0.455056)
     ext:100000x bulk (1000 bytes)                      0.130000   0.030000   0.160000 (  0.158906)
    ruby:10000x multi bulk (10 items x 10 bytes)        0.420000   0.000000   0.420000 (  0.424638)
     ext:10000x multi bulk (10 items x 10 bytes)        0.030000   0.000000   0.030000 (  0.033699)
    ruby:10000x multi bulk (100 items x 10 bytes)       3.850000   0.010000   3.860000 (  3.855463)
     ext:10000x multi bulk (100 items x 10 bytes)       0.260000   0.000000   0.260000 (  0.265152)
    ruby:10000x multi bulk (1000 items x 10 bytes)     39.100000   0.060000  39.160000 ( 39.188940)
     ext:10000x multi bulk (1000 items x 10 bytes)      2.600000   0.000000   2.600000 (  2.607604)

## License

This code is released under the BSD license, after the license of hiredis.
